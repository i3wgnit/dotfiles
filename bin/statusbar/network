#!/bin/sh

DIFF_T=3

PREV_T=$(date +%s)
PREV_RX=$(( $(paste -d '+' /sys/class/net/[ew]*/statistics/rx_bytes) ))
PREV_TX=$(( $(paste -d '+' /sys/class/net/[ew]*/statistics/tx_bytes) ))
sleep "$DIFF_T"
CUR_RX=$(( $(paste -d '+' /sys/class/net/[ew]*/statistics/rx_bytes) ))
CUR_TX=$(( $(paste -d '+' /sys/class/net/[ew]*/statistics/tx_bytes) ))
CUR_T=$(date +%s)

DIFF_T=$(( CUR_T - PREV_T ))
DIFF_RX=$(( CUR_RX - PREV_RX ))
DIFF_TX=$(( CUR_TX - PREV_TX ))

printf '%4sB/s %4sB/s\n' "$(numfmt --to=iec "$(( DIFF_RX / DIFF_T ))")" "$(numfmt --to=iec "$(( DIFF_TX / DIFF_T ))")"
